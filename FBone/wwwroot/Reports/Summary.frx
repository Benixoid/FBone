<?xml version="1.0" encoding="utf-8"?>
<Report ScriptLanguage="CSharp" ReportInfo.Created="06/19/2023 08:41:11" ReportInfo.Modified="06/19/2023 10:47:26" ReportInfo.CreatorVersion="2022.1.0.0">
  <Dictionary>
    <MsSqlDataConnection Name="Connection" ConnectionString="rijcmlqtbDBSzlTxxx25U8ly727raYQ97sXSQGebDc8uwHtInK+ZmBHPEXG1yaiItI3Ofc9x15oQUMR+jA23iIVmnUUuuK9k48Z+/2R2O5LU+VftFbEIdIHWlCahtjCB0fCRDp8swt6EjnbAsq3cBfhrTt6ZOytledzHwhm2IH0WzyvXzoOFwMTNUHJik2CLWEAaGjCEXM9//ADgNnEISAYbCu0/q/wlAfNyKILjDf7FsJzr2g=">
      <TableDataSource Name="Table" Alias="Summary" DataType="System.Int32" Enabled="true" SelectCommand="--Summary report&#13;&#10;declare @ReportDate as datetime&#13;&#10;set @ReportDate = CONVERT(varchar(10), year(GETDATE())) + '-' + CONVERT(varchar(10), month(GETDATE())) + '-' + CONVERT(varchar(10), day(GETDATE())) + CAST('06:00:00' AS DATETIME)&#13;&#10;declare @ReportDate_prev as datetime = DATEADD(day,-1,@ReportDate)&#13;&#10;&#13;&#10;&#13;&#10;select ReportGroup, areaName,iif(fg=0 ,'NonFG','FG') as fg,sum(Force) as Force,sum(Bypass) as Bypass, sum(ActiveForce) as ActiveForce, sum(ActiveBypass) as ActiveBypass, sum(newForce) as newForce, sum(newByp) as newByp, sum(si153) as si153 from&#13;&#10;(&#13;&#10;SELECT a.ReportGroup as ReportGroup, a.Name_EN as areaName, t.isFG as fg, 0 as Force, 0 as Bypass, 0 as ActiveForce, count(*) as ActiveBypass, 0 as newForce, 0 as newByp, 0 as si153 &#13;&#10;FROM &quot;Event&quot; E &#13;&#10;INNER JOIN &quot;Tag&quot; T ON E.TagId = T.Id &#13;&#10;INNER JOIN &quot;tArea&quot; a ON t.AreaId = a.Id &#13;&#10;left join Device d on t.DeviceId = d.Id&#13;&#10;where e.ReportIt=1 &#13;&#10;and e.EventDateTimeSet&lt;@ReportDate&#13;&#10;and (e.EventDateTimeClear is null &#13;&#10;or (e.EventDateTimeClear&gt;@ReportDate and e.EventDateTimeSet&lt;@ReportDate))&#13;&#10;and e.TypeId =2&#13;&#10;group by a.Name_EN, t.isFG, a.ReportGroup&#13;&#10;union all&#13;&#10;SELECT a.ReportGroup as ReportGroup, a.Name_EN as areaName, t.isFG as fg, 0 as Force, 0 as Bypass, count(*) as ActiveForce, 0 as ActiveBypass, 0 as newForce, 0 as newByp, 0 as si153&#13;&#10;FROM &quot;Event&quot; E &#13;&#10;INNER JOIN &quot;Tag&quot; T ON E.TagId = T.Id &#13;&#10;INNER JOIN &quot;tArea&quot; a ON t.AreaId = a.Id &#13;&#10;left join Device d on t.DeviceId = d.Id&#13;&#10;where e.ReportIt=1 &#13;&#10;and e.EventDateTimeSet&lt;@ReportDate&#13;&#10;and (e.EventDateTimeClear is null &#13;&#10;or (e.EventDateTimeClear&gt;@ReportDate and e.EventDateTimeSet&lt;@ReportDate))&#13;&#10;and e.TypeId =1&#13;&#10;group by a.Name_EN, t.isFG, a.ReportGroup&#13;&#10;union all&#13;&#10;SELECT a.ReportGroup as ReportGroup, a.Name_EN as areaName, t.isFG as fg, 0 as Force, count(*) as Bypass,  0 as ActiveForce, 0 as ActiveBypass, 0 as newForce, 0 as newByp, 0 as si153&#13;&#10;FROM &quot;Event&quot; E &#13;&#10;INNER JOIN &quot;Tag&quot; T ON E.TagId = T.Id &#13;&#10;INNER JOIN &quot;tArea&quot; a ON t.AreaId = a.Id &#13;&#10;left join Device d on t.DeviceId = d.Id&#13;&#10;where e.ReportIt=1 &#13;&#10;and e.EventDateTimeSet&lt;@ReportDate&#13;&#10;and e.EventDateTimeSet&gt;@ReportDate_prev&#13;&#10;and e.EventDateTimeClear&lt;@ReportDate&#13;&#10;and e.TypeId=2&#13;&#10;group by a.Name_EN, t.isFG, a.ReportGroup&#13;&#10;union all&#13;&#10;SELECT a.ReportGroup as ReportGroup, a.Name_EN as areaName, t.isFG as fg, count(*) as Force, 0 as Bypass, 0 as ActiveForce, 0 as ActiveBypass, 0 as newForce, 0 as newByp, 0 as si153&#13;&#10;FROM &quot;Event&quot; E &#13;&#10;INNER JOIN &quot;Tag&quot; T ON E.TagId = T.Id &#13;&#10;INNER JOIN &quot;tArea&quot; a ON t.AreaId = a.Id &#13;&#10;left join Device d on t.DeviceId = d.Id&#13;&#10;where e.ReportIt=1 &#13;&#10;and e.EventDateTimeSet&lt;@ReportDate&#13;&#10;and e.EventDateTimeSet&gt;@ReportDate_prev&#13;&#10;and e.EventDateTimeClear&lt;@ReportDate&#13;&#10;and e.TypeId=1&#13;&#10;group by a.Name_EN, t.isFG, a.ReportGroup&#13;&#10;union all&#13;&#10;SELECT a.ReportGroup as ReportGroup, a.Name_EN as areaName, t.isFG as fg, 0 as Force, 0 as Bypass, 0 as ActiveForce, 0 as ActiveBypass, count(*) as newForce, 0 as newByp, 0 as si153&#13;&#10;FROM &quot;Event&quot; E &#13;&#10;INNER JOIN &quot;Tag&quot; T ON E.TagId = T.Id &#13;&#10;INNER JOIN &quot;tArea&quot; a ON t.AreaId = a.Id &#13;&#10;left join Device d on t.DeviceId = d.Id&#13;&#10;where e.ReportIt=1 &#13;&#10;and e.EventDateTimeSet&gt;@ReportDate_prev&#13;&#10;and e.EventDateTimeSet&lt;@ReportDate&#13;&#10;and (e.EventDateTimeClear is null &#13;&#10;or e.EventDateTimeClear&gt;@ReportDate)&#13;&#10;and e.TypeId = 1&#13;&#10;group by a.Name_EN, t.isFG, a.ReportGroup&#13;&#10;union all&#13;&#10;SELECT a.ReportGroup as ReportGroup, a.Name_EN as areaName, t.isFG as fg, 0 as Force, 0 as Bypass, 0 as ActiveForce, 0 as ActiveBypass, 0 as newForce, count(*) as newByp, 0 as si153&#13;&#10;FROM &quot;Event&quot; E &#13;&#10;INNER JOIN &quot;Tag&quot; T ON E.TagId = T.Id &#13;&#10;INNER JOIN &quot;tArea&quot; a ON t.AreaId = a.Id &#13;&#10;left join Device d on t.DeviceId = d.Id&#13;&#10;where e.ReportIt=1 &#13;&#10;and e.EventDateTimeSet&gt;@ReportDate_prev&#13;&#10;and e.EventDateTimeSet&lt;@ReportDate&#13;&#10;and (e.EventDateTimeClear is null &#13;&#10;or e.EventDateTimeClear&gt;@ReportDate)&#13;&#10;and e.TypeId = 2&#13;&#10;group by a.Name_EN, t.isFG, a.ReportGroup&#13;&#10;union all&#13;&#10;SELECT a.ReportGroup as ReportGroup, a.Name_EN as areaName, t.isFG as fg, 0 as Force, 0 as Bypass, 0 as ActiveForce, 0 as ActiveBypass, 0 as newForce, 0 as newByp, count(*) as si153&#13;&#10;FROM &quot;Event&quot; E &#13;&#10;INNER JOIN &quot;Tag&quot; T ON E.TagId = T.Id &#13;&#10;INNER JOIN &quot;tArea&quot; a ON t.AreaId = a.Id &#13;&#10;left join Device d on t.DeviceId = d.Id&#13;&#10;left join tActItems ai on e.ActItemId = ai.Id&#13;&#10;left join tAct ac on ai.ActId = ac.Id&#13;&#10;left JOIN ActHistory ah ON ac.Id = ah.ActId&#13;&#10;where e.ReportIt=1&#13;&#10;and ah.ActionCode = 7&#13;&#10;and e.AddedManually=0&#13;&#10;and e.EventDateTimeSet&gt;@ReportDate_prev&#13;&#10;and e.EventDateTimeSet&lt;@ReportDate&#13;&#10;and (e.EventDateTimeSet&lt;ac.CreatedOn or e.EventDateTimeSet&lt;ah.date)&#13;&#10;group by a.Name_EN, t.isFG, a.ReportGroup&#13;&#10;) a&#13;&#10;group by areaName,fg, ReportGroup&#13;&#10;order by ReportGroup, areaName,fg&#13;&#10;">
        <Column Name="ReportGroup" DataType="System.String"/>
        <Column Name="areaName" DataType="System.String"/>
        <Column Name="fg" DataType="System.String"/>
        <Column Name="Force" DataType="System.Int32"/>
        <Column Name="Bypass" DataType="System.Int32"/>
        <Column Name="ActiveForce" DataType="System.Int32"/>
        <Column Name="ActiveBypass" DataType="System.Int32"/>
        <Column Name="newForce" DataType="System.Int32"/>
        <Column Name="newByp" DataType="System.Int32"/>
        <Column Name="si153" DataType="System.Int32"/>
      </TableDataSource>
    </MsSqlDataConnection>
  </Dictionary>
  <ReportPage Name="Page1" Landscape="true" PaperWidth="297" PaperHeight="210" RawPaperSize="9" FirstPageSource="15" OtherPagesSource="15" LastPageSource="15" Watermark.Font="Arial, 60pt">
    <ReportTitleBand Name="ReportTitle1" Width="1047.06" Height="37.8">
      <TextObject Name="Text1" Left="9.45" Width="697.41" Height="28.35" Text="Forces and Bypasses Summary Report for [FormatDateTime(AddDays([Date],-1),&quot;dd-MMM-yyyy&quot;)]" HorzAlign="Center" Font="Arial, 16pt, style=Bold"/>
      <LineObject Name="Line5" Top="28.35" Width="715.75" Border.Style="DashDotDot" Diagonal="true"/>
    </ReportTitleBand>
    <GroupHeaderBand Name="GroupHeader1" Top="39.8" Width="1047.06" Height="28.35" Condition="[Summary.ReportGroup]" SortOrder="None">
      <TextObject Name="Text2" Left="18.9" Top="4" Width="255.15" Height="18.9" Text="[Summary.ReportGroup]" Font="Arial, 12pt, style=Bold, Italic"/>
      <DataBand Name="Data2" Top="109.95" Width="1047.06" Height="18.9" DataSource="Table">
        <TextObject Name="Text3" Left="18.9" Width="56.7" Height="18.9" Border.Lines="All" Text="[Summary.areaName]" HorzAlign="Center" Font="Arial, 10pt"/>
        <TextObject Name="Text5" Left="75.6" Width="141.75" Height="18.9" Border.Lines="All" Text="[Summary.fg]" HorzAlign="Center" Font="Arial, 10pt"/>
        <TextObject Name="Text169" Left="311.85" Width="94.5" Height="18.9" Border.Lines="All" Text="[IIf([Summary.ActiveForce] != 0,[Summary.ActiveForce],&quot;&quot;)]" HorzAlign="Center" Font="Arial, 10pt"/>
        <TextObject Name="Text160" Left="519.75" Width="113.4" Height="18.9" Border.Lines="All" Text="[IIf([Summary.Bypass] != 0,[Summary.Bypass],&quot;&quot;)]" HorzAlign="Center" VertAlign="Center" Font="Arial, 10pt"/>
        <TextObject Name="Text161" Left="633.15" Width="85.05" Height="18.9" Border.Lines="All" Text="[IIf([Summary.ActiveBypass] != 0,[Summary.ActiveBypass],&quot;&quot;)]" HorzAlign="Center" VertAlign="Center" Font="Arial, 10pt"/>
        <TextObject Name="Text164" Left="406.35" Width="113.4" Height="18.9" Border.Lines="All" Text="[IIf([Summary.newForce] != 0,[Summary.newForce],&quot;&quot;)]" HorzAlign="Center" VertAlign="Center" Font="Arial, 10pt"/>
        <TextObject Name="Text166" Left="718.2" Width="141.75" Height="18.9" Border.Lines="All" Text="[IIf([Summary.newByp] != 0,[Summary.NewByp],&quot;&quot;)]" HorzAlign="Center" VertAlign="Center" Font="Arial, 10pt"/>
        <TextObject Name="Text170" Left="859.95" Width="141.75" Height="18.9" Border.Lines="All" Text="[IIf([Summary.si153] != 0,[Summary.si153],&quot;&quot;)]" HorzAlign="Center" VertAlign="Center" Font="Arial, 10pt"/>
        <TextObject Name="Text158" Left="217.35" Width="94.4" Height="18.9" Border.Lines="All" Text="[IIf([Summary.Force] != 0,[Summary.Force],&quot;&quot;)]&#13;&#10;" HorzAlign="Center" VertAlign="Center" Font="Arial, 10pt"/>
        <DataHeaderBand Name="DataHeader1" Top="70.15" Width="1047.06" Height="37.8">
          <TextObject Name="Text148" Left="75.6" Width="141.75" Height="37.8" Border.Lines="Left, Right, Top" Text="Type" HorzAlign="Center" VertAlign="Center" Font="Arial, 10pt, style=Bold"/>
          <TextObject Name="Text150" Left="18.9" Width="56.7" Height="37.8" Border.Lines="Left, Right, Top" Text="Area" HorzAlign="Center" VertAlign="Center" Font="Arial, 10pt, style=Bold"/>
          <TextObject Name="Text151" Left="217.35" Top="18.9" Width="94.5" Height="18.9" Border.Lines="Left, Right, Top" Text="Total" HorzAlign="Center" Font="Arial, 10pt, style=Bold"/>
          <TextObject Name="Text152" Left="311.85" Top="18.9" Width="94.5" Height="18.9" Border.Lines="Left, Right, Top" Text="Still Active" HorzAlign="Center" Font="Arial, 10pt, style=Bold"/>
          <TextObject Name="Text153" Left="519.75" Top="18.9" Width="113.4" Height="18.9" Border.Lines="Left, Right, Top" Text="Total" HorzAlign="Center" Font="Arial, 10pt, style=Bold"/>
          <TextObject Name="Text154" Left="633.15" Top="18.9" Width="85.05" Height="18.9" Border.Lines="Left, Right, Top" Text="Still Active" HorzAlign="Center" Font="Arial, 10pt, style=Bold"/>
          <TextObject Name="Text163" Left="406.35" Top="18.9" Width="113.4" Height="18.9" Border.Lines="Left, Right, Top" Text="New" HorzAlign="Center" Font="Arial, 10pt, style=Bold"/>
          <TextObject Name="Text165" Left="718.2" Top="18.9" Width="141.75" Height="18.9" Border.Lines="Left, Right, Top" Text="New" HorzAlign="Center" Font="Arial, 10pt, style=Bold"/>
          <TextObject Name="Text167" Left="859.95" Width="141.75" Height="37.8" Border.Lines="Left, Right, Top" Text="Not align &#13;&#10;with SI153" HorzAlign="Center" VertAlign="Center" Font="Arial, 10pt, style=Bold"/>
          <TextObject Name="Text171" Left="217.35" Width="302.4" Height="18.9" Border.Lines="Left, Right, Top" Text="Forces" HorzAlign="Center" Font="Arial, 10pt, style=Bold"/>
          <TextObject Name="Text172" Left="519.75" Width="340.2" Height="18.9" Border.Lines="Left, Right, Top" Text="Bypasses" HorzAlign="Center" Font="Arial, 10pt, style=Bold"/>
        </DataHeaderBand>
      </DataBand>
    </GroupHeaderBand>
  </ReportPage>
</Report>
